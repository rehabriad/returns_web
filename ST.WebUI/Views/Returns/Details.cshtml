@model ST.Entity.Returns

<ol class="breadcrumb">
    <li>@Html.ActionLink(ST.Resource.GlobalResource.NavHome, "Index", "Returns")</li>
    <li class="active">@ST.Resource.ReturnsResource.viewIndexDetails</li>
</ol>
<h2>@ST.Resource.ReturnsResource.viewIndexDetails</h2>
<br />
@if (Model.status != ST.Entity.ReturnStatus.Pending)
{

    <h4>
        @ST.Resource.ReturnsResource.doclocnumDisplayName: @Html.DisplayFor(model => model.docLocNumber)


    </h4>
    <a onclick="PrintDocLocNum('@Model.docLocNumber','@Model.rin','@Model.taxyrmo.ToShortDateString()','@Model.transdate.ToShortDateString()');">طباعة</a>
    <a onclick="PrintElem();">| طباعة اللإقرار </a>

}
<div id="divprint" style="direction:rtl">
    <table class="table table-striped table-bordered table-hover ">
        <tr>
            <td>
                @Html.LabelFor(model => model.returncode, htmlAttributes: new { @class = "control-label col-md-2" })

                <div class="col-md-10">
                    @Html.DisplayFor(model => model.returncode)
                </div>

            </td>
        </tr>
        <tr>
            <td>
                @Html.LabelFor(model => model.rin, htmlAttributes: new { @class = "control-label col-md-2" })

                <div class="col-md-10">
                    @Html.DisplayFor(model => model.rin)
                </div>

            </td>
        </tr>
        <tr>
            <td>
                @Html.LabelFor(model => model.taxyrmo, htmlAttributes: new { @class = "control-label col-md-2" })


                <div class="col-md-10">
                    @Html.DisplayFor(model => model.taxyrmo)
                </div>
            </td>
        </tr>
        <tr>
            <td>
                @Html.LabelFor(model => model.transdate, htmlAttributes: new { @class = "control-label col-md-2" })

                <div class="col-md-10">
                    @Html.DisplayFor(model => model.transdate)
                </div>
            </td>
        </tr>
    </table>
    @if ((int)Model.returncode == 1)
    {
        if (Model.retsale.Any())
        {
            <p>المبيعات</p>
            <table id="retSaleTbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>فئة الضريبة</th>
                    <th>
                        السلعة
                    </th>
                    <th>
                        الخدمات
                    </th>
                    <th>
                        اجمالي القيمة
                    </th>
                    <th>
                        ضريبة القيمة المضافة
                    </th>
                </tr>

                @foreach (var item in Model.retsale)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.taxrateid)</td>
                        <td>@Html.DisplayFor(i => item.goodval)</td>
                        <td>@Html.DisplayFor(i => item.serviceval)</td>
                        <td>@Html.DisplayFor(i => item.saleval)</td>
                        <td>@Html.DisplayFor(i => item.saletax)</td>
                    </tr>
                }


            </table>
        }
        if (Model.retpurch.Any())
        {
            <p>المدخلات</p>
            <table id="retPurchTbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>المدخلات</th>
                    <th>
                        محلي
                    </th>
                    <th>
                        مستورد
                    </th>
                    <th>
                        إجمالي القيمة
                    </th>
                    <th>
                        ضريبة المدخلات
                    </th>
                </tr>

                @foreach (var item in Model.retpurch)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.taxrate)</td>
                        <td>@Html.DisplayFor(i => item.localval)</td>
                        <td>@Html.DisplayFor(i => item.expval)</td>
                        <td>@Html.DisplayFor(i => item.purchval)</td>
                        <td>@Html.DisplayFor(i => item.purchtax)</td>
                    </tr>
                }


            </table>
        }

        if (Model.retcapital.Any())
        {
            <p>السلع الرأسمالية</p>
            <table id="retCapita;Tbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>رصيد سابق</th>
                    <th>
                        ضريبة مسددة خلال شهر
                    </th>
                    <th>
                        الإجمالي
                    </th>
                    <th>
                        ضريبة محصومة في حدود
                        الضريبة المستحقة
                    </th>
                    <th>
                        ضريبة غير
                        قابلة للخصم
                    </th>
                    <th>
                        رصيد مرحل
                    </th>
                </tr>

                @foreach (var item in Model.retcapital)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.prevbalance)</td>
                        <td>@Html.DisplayFor(i => item.paidtax)</td>
                        <td>@Html.DisplayFor(i => item.totalval)</td>
                        <td>@Html.DisplayFor(i => item.discounttax)</td>
                        <td>@Html.DisplayFor(i => item.nondiscounttax)</td>
                        <td>@Html.DisplayFor(i => item.shiftbalance)</td>
                    </tr>
                }


            </table>
        }

        if (Model.retcapital.Any())
        {
            <p>الفواتير</p>
            <table id="retCapita;Tbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>نوع</th>
                    <th>
                        عدد
                    </th>
                    <th>
                        رقم المسلسل من
                    </th>
                    <th>رقم المسلسل الى
                    </th>
                </tr>

                @foreach (var item in Model.retreceit)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.recietcode)</td>
                        <td>@Html.DisplayFor(i => item.recietno)</td>
                        <td>@Html.DisplayFor(i => item.recietserialfrom)</td>
                        <td>@Html.DisplayFor(i => item.recietserialto)</td>
                    </tr>
                }


            </table>
        }

        if (Model.retlocalpurch.Any())
        {
            <p>بيان المشتريات محلي</p>
            <table id="retCapita;Tbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>اسم المورد</th>
                    <th>
                        رقم التسجيل
                    </th>
                    <th>
                        خاضع
                    </th>
                    <th>
                        معفى
                    </th>
                    <th>
                        غير قابل للخصم
                    </th>
                    <th>
                        فئة الضريبة
                    </th>
                    <th>
                        ضريبة القيمة المضافة
                    </th>
                    <th>
                        رقم الفاتورة
                    </th>
                    <th>
                        تاريخ الفاتورة
                    </th>
                </tr>

                @foreach (var item in Model.retlocalpurch)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.supplyname)</td>
                        <td>@Html.DisplayFor(i => item.rin)</td>
                        <td>@Html.DisplayFor(i => item.deppurch)</td>
                        <td>@Html.DisplayFor(i => item.nondispurch)</td>
                        <td>@Html.DisplayFor(i => item.indeppurch)</td>
                        <td>@Html.DisplayFor(i => item.taxrateid)</td>
                        <td>@Html.DisplayFor(i => item.vattax)</td>
                        <td>@Html.DisplayFor(i => item.recietserial)</td>
                        <td>@Html.DisplayFor(i => item.recietdate)</td>
                    </tr>
                }


            </table>
        }
        if (Model.retexpurch.Any())
        {
            <p>بيان المشتريات مستورد</p>
            <table id="retCapita;Tbl" class="table table-striped table-bordered table-hover" style="direction: rtl">
                <tr>
                    <th>نوع الشهادة</th>
                    <th>
                        عدد الشهادات
                    </th>
                    <th>
                        إجمالي القيمة
                    </th>
                    <th>
                        فئة الضريبة
                    </th>
                    <th>
                        الضريبة
                    </th>
                </tr>

                @foreach (var item in Model.retexpurch)
                {
                    <tr>
                        <td>@Html.DisplayFor(i => item.recietcode)</td>
                        <td>@Html.DisplayFor(i => item.certno)</td>
                        <td>@Html.DisplayFor(i => item.totalvalue)</td>
                        <td>@Html.DisplayFor(i => item.taxrateid)</td>
                        <td>@Html.DisplayFor(i => item.tax)</td>
                    </tr>
                }


            </table>
        }
        <table class="table table-striped table-bordered">
            <tr>
                <td>
                    @Html.LabelFor(model => model.saleltc, htmlAttributes: new { @class = "control-label col-md-2" })

                    <div class="col-md-10">
                        @Html.DisplayFor(model => model.saleltc)
                    </div>

                </td>
            </tr>
            <tr>
                <td>
                    @Html.LabelFor(model => model.purctdt2, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.DisplayFor(model => model.purctdt2)
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    @Html.LabelFor(model => model.nettaxpy, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.DisplayFor(model => model.nettaxpy)
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    @Html.LabelFor(model => model.docLocNumber, htmlAttributes: new { @class = "control-label col-md-2" })

                    <div class="col-md-10">
                        @Html.DisplayFor(model => model.docLocNumber)
                    </div>
                </td>
            </tr>
        </table>

    }
</div>
<p>
    @if (Model.status == ST.Entity.ReturnStatus.Pending)
    {
        @Html.ActionLink(@ST.Resource.ReturnsResource.viewIndexEdit, "Edit", new { id = Model.Id }, new { onclick = "CheckRetcode( '" + (int)Model.returncode + "');" })   <span>|</span>
        @Html.ActionLink(@ST.Resource.ReturnsResource.viewIndexSend, "Send", new { id = Model.Id })<span>|</span>
    }

    @Html.ActionLink("العودة للقائمة", "Index")
</p>
@section scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            var isPrint = '@ViewBag.IsPrint';
            console.log(isPrint);
            if (isPrint.toLowerCase() == 'true')
                PrintDocLocNum('@Model.docLocNumber', '@Model.rin', '@Model.taxyrmo.ToShortDateString()', '@Model.transdate.ToShortDateString()');
        });
        function PrintElem() {
            //  Popup($("#divprint").html());
            var divContents = $('#divprint').html();
            var printWindow = window.open('', '', ',width=800');
            printWindow.document.write('<html>');
            printWindow.document.write('<link rel="stylesheet" type="text/css" href="Content/print.css"/>');
            printWindow.document.write('<body >');
            printWindow.document.write(divContents);
            printWindow.document.write('</body></html>');
            printWindow.print();
            printWindow.close();
        }

        function Popup(data) {
            var mywindow = window.open('', 'new div', 'height=400,width=600');
            mywindow.document.write('<html><head><title>my div</title>');
            /*optional stylesheet*/ //mywindow.document.write('<link rel="stylesheet" href="main.css" type="text/css" />');
            mywindow.document.write('</head><body >');
            mywindow.document.write(data);
            mywindow.document.write('</body></html>');

            mywindow.print();
            mywindow.close();

            return true;
        }
    </script>
}